#
# This is the environments definition. You can define (and select) different environments (e.g. '-e default' or '-e spanish')
#
# You can define the following resolution strategies: 
# - (plain string)
# - $env
# - $cmd
# - $stdin
# - $resolve
#
env:
  default:
    username:
      $env: USER
    GIT_COMMIT:
      $cmd: git rev-parse --short HEAD || echo "NOT_AVAILABLE"

# This is the scripts section. It uses hierarchies to guide the user. Go as deep as you want!
scripts:
  install:
    local:
      $cmd: npm i -g --force .
    global:
      $cmd: npm i -g --force @mountainpass/hooked-cli
  uninstall:
    local:
      $cmd: npm uninstall -g --force hooked
    global:
      $cmd: npm uninstall -g --force @mountainpass/hooked-cli
  lerna:
    install:
      $cmd: npx lerna exec --scope @mountainpass/* npm install
    build:
      $cmd: npx lerna run --scope @mountainpass/* build
    bump:
      $cmd: npx lerna version patch --yes --force-publish --message '%s [skip ci]'
    publish:
      $cmd: npx lerna publish from-package --yes
  publish:
    $cmd: |
      lerna exec --scope @mountainpass/* npm install
      lerna run --scope @mountainpass/* build
      lerna version patch --yes --force-publish --message '%s [skip ci]'
      lerna publish from-package --yes
